<script type="text/javascript" charset="utf-8">

navId = null
currentUser = null
usersArray = []

$(function () {
  profileOrHomeTemplate();
  $(".main").on("click", function(e) {
      if (!$(e.target).is("button")) {
      hideTopNav();
    }
  });
});

// welcome page functions

function profileOrHomeTemplate() {
  currentUser = `<%= current_user.id if current_user %>`
  if (currentUser === ``) {
    homeTemplate();
  } else {
    currentUserProfileTemplate();
  }
}

function currentUserProfileTemplate() {
  hideSideNav();
  $.get(`/users/${currentUser}.json`, function(data) {
    if (data.admin) {
      $(".main").empty();
      $(".main").append('<%= j render '/users/admin_show' %>');
    } else {
      $(".main").empty();
      $(".main").append('<%= j render '/users/non_admin_show' %>');
      $(window).scrollTop(0);
      enlargeLoggedInIcon();
      shrinkLoggedInIcon();
      hideTopNav();
    }
  });
}

// proposal functions

function editProposalTemplate() {
  hideCurrentUserProfileTemplate()
  hideSideNav();
  $.get(`/users/${currentUser}.json`, function(data) {
    proposal = data.proposal
    $(".main").append(`
      <div id="editProposalDetails">
        <h1 style="font-size:60;">Edit Proposal</h1>
        <hr>
        <form class="edit_proposal" id="edit_proposal_${proposal.id}" action="/proposals/${proposal.id}" accept-charset="UTF-8" method="post">
          <h2>Name</h2>
          <input type="text" value="${proposal.name}" name="proposal[name]" id="proposal_name"><p></p>
          <h2>Brief Description (75 characters or less)</h2>
          <textarea cols="50" name="proposal[description]" id="proposal_description">${proposal.description}</textarea>
          <h2>Why should she be considered?</h2>
          <textarea cols="50" rows="10" name="proposal[pitch]" id="proposal_pitch">${proposal.pitch}</textarea>
          <h2>Historical Image</h2>
          <textarea cols="50" name="proposal[image_url]" id="proposal_image_url">${proposal.image_url}</textarea>
          <input type="submit" name="commit" value="Update Proposal" data-disable-with="Update Proposal">
        </form>
      </div>
    `);
    $("#editProposalDetails").animate({"right": "-33%"}, 10, function() {});
    editProposal(proposal.id)
  })

}

function loginDropDown() {
  $("#login").append('<%= j render "/sessions/login" %>');
  $("#login").css({
    "position":"relative",
    "top":"-20px"
  })
  $("#loginForm input").css({
    "height":"43px",
    "background-color": "rgba(255,255,255,0)",
    "border":"1px solid #3bb9ff",
    "border-radius":"5px",
    "font-size":"25px"
  });
  $("#loginForm input[type='submit']").css({
    "height":"40px",
    "border": "1px solid orange",
    "color":"white",
    "cursor":"pointer"
  });
  $("#loginForm a").css({
    "position": "relative",
    "left":"100px",
    "color":"white",
    "text-decoration":"none"
  })
  $("[type='submit']").removeAttr("data-disable-with");
}

</script>
